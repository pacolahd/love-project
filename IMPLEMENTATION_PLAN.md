# Valentine's Day Digital Brochure - Implementation Plan

## Overview
A Valentine's Day website with page-flip animations, personalized messages (Gospel & Purity themes), follow-up forms, and analytics tracking.

## Tech Stack
- **Framework**: Next.js 16 with React 19, App Router
- **Styling**: Tailwind CSS v4
- **Animations**: Framer Motion
- **Backend**: Convex (real-time database + serverless functions)
- **Deployment**: Vercel (later)

---

## File Structure

```
love-project/
├── app/
│   ├── layout.tsx                    # Root layout with metadata
│   ├── page.tsx                      # Homepage redirect to /wish
│   ├── globals.css                   # Valentine theme styles
│   ├── ConvexClientProvider.tsx      # Convex provider wrapper
│   └── wish/
│       └── page.tsx                  # Main brochure page
├── convex/
│   ├── _generated/                   # Auto-generated by Convex
│   ├── schema.ts                     # Database schema
│   ├── visits.ts                     # Visit mutations/queries
│   ├── followups.ts                  # Followup mutations/queries
│   └── shares.ts                     # Share mutations/queries
├── components/
│   ├── brochure/
│   │   ├── Brochure.tsx              # Main container with state
│   │   ├── BrochurePage.tsx          # Page wrapper with flip animation
│   │   ├── CoverPage.tsx             # Flower image + greeting
│   │   ├── GiftSelectionPage.tsx     # Option 1 & 2 cards
│   │   ├── GospelPage.tsx            # God's love message + follow-up modal
│   │   ├── PurityPage.tsx            # Purity in relationships message
│   │   └── SharePage.tsx             # Create & share form
│   ├── ui/
│   │   ├── Button.tsx
│   │   ├── Input.tsx
│   │   ├── Modal.tsx
│   │   └── Card.tsx
│   └── forms/
│       ├── FollowUpForm.tsx          # Name + phone/email form
│       └── ShareForm.tsx             # Create shareable link
├── hooks/
│   └── useBrochure.ts                # Brochure state management
├── .env.local                        # CONVEX_DEPLOYMENT, NEXT_PUBLIC_CONVEX_URL
└── public/
    └── images/
        ├── flower.svg
        └── heart.svg
```

---

## Database Schema (Convex)

```typescript
// convex/schema.ts
import { defineSchema, defineTable } from "convex/server";
import { v } from "convex/values";

export default defineSchema({
  visits: defineTable({
    senderName: v.string(),
    receiverName: v.string(),
    viewedOption1: v.boolean(),
    viewedOption2: v.boolean(),
  }),

  followups: defineTable({
    visitId: v.id("visits"),
    name: v.string(),
    phone: v.optional(v.string()),
    email: v.optional(v.string()),
  }),

  shares: defineTable({
    senderName: v.string(),
    receiverName: v.string(),
  }),
});
```

### Convex Functions

```typescript
// convex/visits.ts
import { mutation, query } from "./_generated/server";
import { v } from "convex/values";

export const create = mutation({
  args: { senderName: v.string(), receiverName: v.string() },
  handler: async (ctx, args) => {
    return await ctx.db.insert("visits", {
      ...args,
      viewedOption1: false,
      viewedOption2: false,
    });
  },
});

export const markOptionViewed = mutation({
  args: { visitId: v.id("visits"), option: v.number() },
  handler: async (ctx, { visitId, option }) => {
    const field = option === 1 ? "viewedOption1" : "viewedOption2";
    await ctx.db.patch(visitId, { [field]: true });
  },
});
```

### Analytics Tracking Logic

| Event | Database Action |
|-------|-----------------|
| Link opened (`/wish?from=X&to=Y`) | Create `visits` record |
| Option 1 clicked | Update `visits.viewedOption1 = true` |
| Option 2 clicked | Update `visits.viewedOption2 = true` |
| Follow-up form submitted | Create `followups` record |
| Share link created | Create `shares` record |

---

## Page Flow

```
[Cover Page] → [Gift Selection] → [Option 1: Gospel] or [Option 2: Purity] → [Share Page]
     │                │                    │                    │
     │                │                    │                    │
  Flower +         Option 1            Message +            Message +
  Greeting         Option 2          Follow-up Modal      "See other?"
  "Open Gift"                        "See other?"
```

### URL Structure
- `/wish?from=John&to=Mary` - Personalized link
- Names displayed throughout the experience

---

## Implementation Steps

### Phase 1: Setup (Foundation)

**Step 1.1: Install Dependencies**
```bash
npm install convex framer-motion
npx convex dev
```
This will:
- Prompt you to log in to Convex (creates account if needed)
- Create a new Convex project
- Generate `convex/_generated/` folder
- Add environment variables to `.env.local`

**Step 1.2: Create Convex Provider**
- Create `app/ConvexClientProvider.tsx`
- Wrap app in provider in `layout.tsx`

**Step 1.3: Create Schema & Functions**
- Create `convex/schema.ts` with visits, followups, shares tables
- Create `convex/visits.ts`, `convex/followups.ts`, `convex/shares.ts`

### Phase 2: UI Components
1. Create UI primitives: `Button`, `Input`, `Modal`, `Card`
2. Set up Valentine theme colors in `globals.css`

### Phase 3: Brochure Components
1. Create `BrochurePage.tsx` with flip animation
2. Create `Brochure.tsx` container with state
3. Build each page component:
   - `CoverPage.tsx`
   - `GiftSelectionPage.tsx`
   - `GospelPage.tsx` (with modal trigger)
   - `PurityPage.tsx`
   - `SharePage.tsx`

### Phase 4: Convex Functions
1. `convex/visits.ts` - create, markOptionViewed queries/mutations
2. `convex/followups.ts` - create mutation
3. `convex/shares.ts` - create mutation

### Phase 5: Forms & Integration
1. `FollowUpForm.tsx` - Name (required) + Phone OR Email (one required)
2. `ShareForm.tsx` - Sender name + Receiver name → Generate link
3. `useBrochure.ts` hook for state management

### Phase 6: Wish Route
1. Create `app/wish/page.tsx` with Suspense boundary
2. Update `app/page.tsx` to redirect or show create form

### Phase 7: Polish
1. Add placeholder content for Gospel and Purity messages
2. Add flower/heart images
3. Mobile optimization
4. Test full flow

---

## Page Flip Animation Approach

Using Framer Motion with 3D transforms:

```typescript
const pageVariants = {
  enter: (direction: 'forward' | 'backward') => ({
    rotateY: direction === 'forward' ? 90 : -90,
    opacity: 0,
  }),
  center: { rotateY: 0, opacity: 1 },
  exit: (direction: 'forward' | 'backward') => ({
    rotateY: direction === 'forward' ? -90 : 90,
    opacity: 0,
  }),
};
```

---

## Key Files to Create/Modify

1. `app/ConvexClientProvider.tsx` - Convex provider
2. `app/layout.tsx` - Wrap with Convex provider
3. `convex/schema.ts` - Database schema
4. `convex/visits.ts` - Visit mutations
5. `convex/followups.ts` - Followup mutations
6. `convex/shares.ts` - Share mutations
7. `app/wish/page.tsx` - Main route
8. `components/brochure/Brochure.tsx` - Core container
9. `hooks/useBrochure.ts` - State management
10. `components/ui/Modal.tsx` - For follow-up form
11. `app/globals.css` - Valentine theme

---

## Verification Plan

1. **Convex Dashboard**: Open dashboard at https://dashboard.convex.dev to view tables
2. **Visit tracking**: Open `/wish?from=Test&to=User`, check `visits` table in dashboard
3. **Option tracking**: Click Option 1, verify `viewedOption1 = true` in dashboard
4. **Follow-up form**: Submit form, verify `followups` record appears
5. **Share**: Create link, verify `shares` record appears
6. **Full flow**: Test complete user journey on mobile and desktop
